#################################################################
## USER BREIFING
#################################################################
#
#############################################################
##  Art Weekdays
#############################################################
- id: art_weekday_briefing
  alias: Art Weekday Briefing
  initial_state: true
  trigger:
  - platform: state
    entity_id: binary_sensor.kit_motion_sensor_81
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.daily_briefing_art
    state: 'on'
  - condition: time
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
  - condition: time
    after: '06:30'
    before: '09:00'
  - condition: state
    entity_id: binary_sensor.sleepnumber_cc04b4013d81_art_is_in_bed
    state: 'off'
    for:
      minutes: 3
  - condition: template
    # Only run if more than 6 hours (21,600 sec) since it last ran
    value_template: '{{(as_timestamp(now()) - as_timestamp(state_attr("automation.art_weekday_briefing", "last_triggered") | default(0)) | int > 21600 )}}'
  action:
  - service: script.turn_on
    entity_id: script.daily_briefing_alert
  - delay: 0:00:05
  - service: script.turn_on
    entity_id: script.art_briefing_one
#
#############################################################
##  Art Weekends
#############################################################
- id: art_weekend_briefing
  alias: Art Weekend Briefing
  initial_state: true
  trigger:
  - platform: state
    entity_id: binary_sensor.kit_motion_sensor_81
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.daily_briefing_art
    state: 'on'
  - condition: time
    weekday:
    - sat
    - sun
  - condition: time
    after: '06:30'
    before: '09:00'
  - condition: state
    entity_id: binary_sensor.sleepnumber_cc04b4013d81_art_is_in_bed
    state: 'off'
    for:
      minutes: 3
  - condition: template
    # Only run if more than 6 hours (21,600 sec) since it last ran
    value_template: '{{(as_timestamp(now()) - as_timestamp(state_attr("automation.art_weekend_briefing", "last_triggered") | default(0)) | int > 21600 )}}'
  action:
  - service: script.turn_on
    entity_id: script.daily_briefing_alert
  - delay: 0:00:05
  - service: script.turn_on
    entity_id: script.art_briefing_one
#
#############################################################
##  Steff Weekdays
#############################################################
- id: steff_weekday_briefing
  alias: Steff Weekday Briefing
  initial_state: true
  trigger:
  - platform: state
    entity_id: binary_sensor.kit_motion_sensor_81
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.daily_briefing_steff
    state: 'on'
  - condition: time
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
  - condition: time
    after: '08:30'
    before: '09:30'
  - condition: state
    entity_id: binary_sensor.sleepnumber_cc04b4013d81_steff_is_in_bed
    state: 'off'
  - condition: template
    # Only run if more than 6 hours (21,600 sec) since it last ran
    value_template: '{{(as_timestamp(now()) - as_timestamp(state_attr("automation.steff_weekday_briefing", "last_triggered") | default(0)) | int > 21600 )}}'
  action:
  - service: script.turn_on
    entity_id: script.daily_briefing_alert
  - delay: 0:00:05
  - service: script.turn_on
    entity_id: script.steff_briefing_one
#
#############################################################
##  Steff Weekends
#############################################################
- id: steff_weekend_briefing
  alias: Steff Weekend Briefing
  initial_state: true
  trigger:
  - platform: state
    entity_id: binary_sensor.kit_motion_sensor_81
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.daily_briefing_steff
    state: 'on'
  - condition: time
    weekday:
    - sat
    - sun
  - condition: time
    after: '08:30'
    before: '09:30'
  - condition: state
    entity_id: binary_sensor.sleepnumber_cc04b4013d81_steff_is_in_bed
    state: 'off'
    for:
      minutes: 3
  - condition: template
    # Only run if more than 6 hours (21,600 sec) since it last ran
    value_template: '{{(as_timestamp(now()) - as_timestamp(state_attr("automation.steff_weekend_briefing", "last_triggered") | default(0)) | int > 21600 )}}'
  action:
  - service: script.turn_on
    entity_id: script.daily_briefing_alert
  - delay: 0:00:05
  - service: script.turn_on
    entity_id: script.steff_briefing_one
#
#############################################################
##  Test Briefing
#############################################################
- id: test_briefing
  alias: Test Briefing
  initial_state: true
  trigger:
  - platform: state
    entity_id: input_boolean.trigger_sandbox
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.enable_sandbox
    state: 'on'
  action:
#  - delay: 0:00:10
#  - service: script.turn_on
#    entity_id: script.daily_briefing_alert
#  - delay: 0:00:05
  - service: script.turn_on
    entity_id: script.test_briefing_one
  - delay: 0:00:02
  - service: input_boolean.turn_off
    entity_id: input_boolean.trigger_sandbox
#
